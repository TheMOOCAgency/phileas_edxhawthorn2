## mako

<%page expression_filter="h" args="online_help_token"/>

<%namespace name='static' file='../static_content.html'/>
<%namespace file='../main.html' import="login_query"/>
<%!
from django.urls import reverse
from django.utils.translation import ugettext as _
from openedx.core.djangoapps.site_configuration import helpers as configuration_helpers
from openedx.core.djangoapps.lang_pref.api import header_language_selector_is_enabled, released_languages
%>

<%
  show_explore_courses = settings.FEATURES.get('COURSES_ARE_BROWSABLE') and not show_program_listing
  show_sysadmin_dashboard = settings.FEATURES.get('ENABLE_SYSADMIN_DASHBOARD','') and user.is_staff
  self.real_user = getattr(user, 'real_user', user)

  support_link = configuration_helpers.get_value('SUPPORT_SITE_LINK', settings.SUPPORT_SITE_LINK)
  doc_link = get_online_help_info(online_help_token)['doc_url']

  if online_help_token == "instructor":
    help_link = doc_link
  elif support_link:
    help_link = support_link
  else:
    help_link = doc_link
%>

<div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="${reverse('home_dashboard')}">${_("Hello")} ${user.email}</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="${reverse('home_dashboard')}">${_("My activity")}</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="${reverse('courses')}">${_("Explore")}</a>
      </li>
      % if header_language_selector_is_enabled():
      <% languages = released_languages() %>
      % if len(languages) > 1:
        <form action="/i18n/setlang/" method="post" class="settings-language-form" id="language-settings-form">
            <input type="hidden" id="csrf_token" name="csrfmiddlewaretoken" value="${csrf_token}">
            % if user.is_authenticated:
                <input title="preference api" type="hidden" class="url-endpoint" value="${reverse('preferences_api', kwargs={'username': user.username})}" data-user-is-authenticated="true">
            % else:
                <input title="session update url" type="hidden" class="url-endpoint" value="${reverse('session_language')}" data-user-is-authenticated="false">
            % endif
            <!--BUTTON SWITCH-->
            <a class="nav-link align-middle language">
                <span id="fr">FR</span>
                <label class="switch">
                    <span class="slider round"></span>
                </label>
                <span id="en">EN</span>
            </a>
            <select class="input select language-selector" id="settings-language-value" name="language">
                % for language in languages:
                    % if language[0] == LANGUAGE_CODE:
                        <option value="${language[0]}" selected="selected">${language[1]}</option>
                    % else:
                        <option value="${language[0]}" >${language[1]}</option>
                    % endif
                % endfor
            </select>
            </label>
        </form>
      % endif
    % endif
    </ul>
    <!--<form class="form-inline my-2 my-lg-0">
      <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
      <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
    </form>-->
  </div>
</div>
<script>
    $(document).ready(function(){
        if ($('#settings-language-value > option[value="en"]').attr('selected')) {
            $('.switch').toggleClass('en')
        }
        // Language selector
        $('#en').click(function(){
            $('#settings-language-value > option[value="en"]').attr('selected','selected');
            $('#settings-language-value > option[value="fr"]').removeAttr('selected').trigger("change");
            $('.switch').toggleClass('en')
        });
        $('#fr').click(function(){
            $('#settings-language-value > option[value="fr"]').attr('selected','selected');
            $('#settings-language-value > option[value="en"]').removeAttr('selected').trigger("change");
            $('.switch').toggleClass('fr')
        });
    });
</script>
</script>
