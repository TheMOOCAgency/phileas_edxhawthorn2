(this["webpackJsonpnew-tma-dashboard"]=this["webpackJsonpnew-tma-dashboard"]||[]).push([[0],{82:function(e,t,a){e.exports=a(95)},95:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(8),c=a.n(l),o=a(19),i=a(24),s=a(65),u=a(12),m={enrollments:{},courses:{},selectedEnrollments:{},displayGlobalMode:!0},d={},b=Object(i.c)({userManagement:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_USER_ENROLLMENTS":return Object(u.a)(Object(u.a)({},e),{},{enrollments:Object(u.a)(Object(u.a)({},e.enrollments),t.payload.user_enrollments_profiles),courses:Object(u.a)(Object(u.a)({},e.courses),t.payload.org_courses)});case"FILTER_USERS_ENROLLMENTS_BY_COURSE":return Object(u.a)(Object(u.a)({},e),{},{selectedEnrollments:Object(u.a)({},t.payload),displayGlobalMode:!1});case"SET_DISPLAY_MODE":return Object(u.a)(Object(u.a)({},e),{},{displayGlobalMode:t.payload});default:return e}},quickSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;return t.type,e}}),E=a(17),p=a(138),f=a(144),O=a(128),g=a(73),h=Object(g.a)({palette:{primary:{main:window.props.colors.primary_color},background:{main:"#E5E5E5",clear:"#FFFFFF"}},text:{font:{main:"Montserrat"}}}),j=a(74),v=function(e){var t=e.children,a=e.value,n=e.index,l=Object(j.a)(e,["children","value","index"]);return r.a.createElement("div",Object.assign({role:"tabpanel",hidden:a!==n,id:"scrollable-auto-tabpanel-".concat(n),"aria-labelledby":"scrollable-auto-tab-".concat(n)},l),a===n&&r.a.createElement(O.a,null,t))},y=function(){return r.a.createElement(O.a,{container:!0,direction:"column",justify:"center",alignItems:"center",style:{fontWeight:700}},"Available soon !")},k=a(143),_=a(149),S=a(131),w=a(132),x=a(69),C=a.n(x),M=a(31),P=a(36),N=a.n(P),T=a(52),R=function(e){var t=e.course,a=e.globalMode,l=Object(o.c)((function(e){return{enrollments:e.userManagement.enrollments}})).enrollments,c=Object(o.b)(),i=Object(n.useCallback)((function(){c(function(e){return{type:"SET_DISPLAY_MODE",payload:e}}(a))}),[c,a]),s=Object(n.useCallback)((function(){c(function(e,t){var a={};return t&&Object.entries(e).forEach((function(e){e[1].enrollments.hasOwnProperty(t)&&(a.hasOwnProperty(e[0])||(a[e[0]]=Object(u.a)({},e[1]),a[e[0]].enrollments={}),a.hasOwnProperty(e[0])&&e[1].enrollments.hasOwnProperty(t)&&(a[e[0]].enrollments=Object(u.a)(Object(u.a)({},a[e[0]].enrollments),Object(M.a)({},t,e[1].enrollments[t]))))})),{type:"FILTER_USERS_ENROLLMENTS_BY_COURSE",payload:a}}(l,t[0]))}),[t,c,l]),m=Object(n.useCallback)((function(){return t?"#2D9CDB":"black"}),[t]);return r.a.createElement("div",{onClick:function(){return a?i():s()}},r.a.createElement(_.a,null,r.a.createElement(S.a,{primary:t?t[1].display_name:"Global"}),r.a.createElement(C.a,{style:{backgroundColor:m(),color:"white",padding:10,borderRadius:"10%",marginRight:20}})),r.a.createElement(w.a,null))},F=function(e){var t=e.courses,a=Object(n.useCallback)((function(){return Object.entries(t).map((function(e){return r.a.createElement(R,{key:e[0],course:e,globalMode:!1})}))}),[t]),l=Object(n.useCallback)((function(){return r.a.createElement(R,{globalMode:!0})}),[]);return r.a.createElement(n.Fragment,null,l(),a())},L=a(133),D=a(146),U=function(e){var t=e.value,a=e.handleChangeTab,l=e.tabsList,c=Object(n.useCallback)((function(){return l.map((function(e,t){return r.a.createElement(L.a,{label:e,key:t})}))}),[l]);return r.a.createElement(D.a,{value:t,indicatorColor:"primary",textColor:"primary",onChange:a},c())},I=function(){return r.a.createElement(n.Fragment,null,r.a.createElement(O.a,{item:!0,xs:12},"Course",r.a.createElement(w.a,null)),r.a.createElement(O.a,{container:!0,direction:"row"},r.a.createElement(O.a,{item:!0,xs:6},"Overview",r.a.createElement(w.a,null)),r.a.createElement(O.a,{item:!0,xs:6},"Generate reports",r.a.createElement(w.a,null))))},A=a(3),B=a(70),G=a.n(B),H=a(11),Y=a(60),q=a.n(Y),W=a(71),J=a.n(W),V=a(72),X=a.n(V),z=a(134),Q=a(135),K=a(136),Z=a(147),$=a(148),ee=a(139),te=a(56),ae=a(140),ne=a(141),re=a(142),le=a(145),ce=function(e,t,a){if(-1!==["is_active","last_name","username"].indexOf(a))return t[a]<e[a]?-1:t[a]>e[a]?1:0;var n=Object(u.a)({},e),r=Object(u.a)({},t);return n.enrollments.hasOwnProperty(a)||(n.enrollments[a]={enrollment_date:""}),r.enrollments.hasOwnProperty(a)||(r.enrollments[a]={enrollment_date:""}),t.enrollments[a].enrollment_date<e.enrollments[a].enrollment_date?-1:t.enrollments[a].enrollment_date>e.enrollments[a].enrollment_date?1:void 0},oe=function(e){var t=e.classes,a=e.onSelectAllClick,l=e.order,c=e.orderBy,o=e.numSelected,i=e.rowCount,s=e.onRequestSort,u=e.courses,m=Object(n.useState)([]),d=Object(E.a)(m,2),b=d[0],p=d[1];Object(n.useEffect)((function(){var e=[{id:"is_active",numeric:!1,disablePadding:!0,label:"User Status"},{id:"last_name",numeric:!1,disablePadding:!1,label:"Name"},{id:"username",numeric:!1,disablePadding:!1,label:"Username"}];u.sort().forEach((function(t){e.push({id:t,numeric:!1,disablePadding:!1,label:t})})),p(e)}),[u]);return r.a.createElement(z.a,null,r.a.createElement(Q.a,null,r.a.createElement(K.a,{padding:"checkbox"},r.a.createElement(Z.a,{indeterminate:o>0&&o<i,checked:i>0&&o===i,onChange:a,inputProps:{"aria-label":"select user"}})),b.map((function(e){return r.a.createElement(K.a,{key:e.id,align:e.numeric?"right":"left",padding:e.disablePadding?"none":"default",sortDirection:c===e.id&&l},r.a.createElement($.a,{active:c===e.id,direction:c===e.id?l:"asc",onClick:(a=e.id,function(e){s(e,a)})},e.label,c===e.id?r.a.createElement("span",{className:t.visuallyHidden},"desc"===l?"sorted descending":"sorted ascending"):null));var a}))))},ie=Object(p.a)((function(e){return{root:{paddingLeft:e.spacing(2),paddingRight:e.spacing(1)},highlight:{color:e.palette.primary.main,backgroundColor:Object(H.d)(e.palette.primary.main,.85)},title:{flex:"1 1 100%"}}})),se=function(e){var t=e.numSelected,a=ie();return r.a.createElement(ee.a,{className:Object(A.a)(a.root,Object(M.a)({},a.highlight,t>0))},t>0?r.a.createElement(te.a,{className:a.title,color:"inherit",variant:"subtitle1",component:"div"},t," selected"):r.a.createElement(te.a,{className:a.title,variant:"h6",id:"tableTitle",component:"div"},"All enrollments"))},ue=Object(p.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}})),me=function(){var e=ue(),t=Object(n.useState)("asc"),a=Object(E.a)(t,2),l=a[0],c=a[1],i=Object(n.useState)("username"),s=Object(E.a)(i,2),u=s[0],m=s[1],d=Object(n.useState)([]),b=Object(E.a)(d,2),p=b[0],f=b[1],O=Object(n.useState)(0),g=Object(E.a)(O,2),h=g[0],j=g[1],v=Object(n.useState)(5),y=Object(E.a)(v,2),k=y[0],_=y[1],S=Object(o.c)((function(e){return{enrollments:e.userManagement.enrollments,selectedEnrollments:e.userManagement.selectedEnrollments,globalMode:e.userManagement.displayGlobalMode,courses:e.userManagement.courses}})),w=S.enrollments,x=S.selectedEnrollments,C=S.globalMode,M=S.courses,P=Object(n.useState)(w),R=Object(E.a)(P,2),F=R[0],L=R[1],D=Object(o.b)(),U=Object(n.useCallback)(Object(T.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(function(){var e=Object(T.a)(N.a.mark((function e(t){var a,n,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={},n={method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}},e.next=6,fetch("/tma_apps/view_enrollments",n);case 6:return r=e.sent,e.next=9,r.json();case 9:a=e.sent,e.next=13;break;case 12:a=window.props;case 13:t({type:"FETCH_USER_ENROLLMENTS",payload:a});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),[D]);Object(n.useEffect)((function(){U()}),[U]),Object(n.useEffect)((function(){L(C?w:x)}),[x,w,C]);var I=k-Math.min(k,Object.keys(F).length-h*k);return r.a.createElement("div",{className:e.root},r.a.createElement(se,{numSelected:p.length}),r.a.createElement(ae.a,null,r.a.createElement(ne.a,{className:e.table,"aria-labelledby":"tableTitle",size:"medium","aria-label":"enhanced table"},r.a.createElement(oe,{classes:e,numSelected:p.length,order:l,orderBy:u,onSelectAllClick:function(e){if(e.target.checked){var t=Object.values(F).map((function(e){return e.username}));f(t)}else f([])},onRequestSort:function(e,t){c(u===t&&"asc"===l?"desc":"asc"),m(t)},rowCount:Object.keys(F).length,courses:C?Object.keys(M):["Enrollment status"]}),r.a.createElement(re.a,null,function(e,t){var a=e.map((function(e,t){return[e,t]}));return a.sort((function(e,a){var n=t(e[0],a[0]);return 0!==n?n:e[1]-a[1]})),a.map((function(e){return e[0]}))}(Object.values(F),function(e,t){return"desc"===e?function(e,a){return ce(e,a,t)}:function(e,a){return-ce(e,a,t)}}(l,u)).slice(h*k,h*k+k).map((function(e,t){var a,l=(a=e.username,-1!==p.indexOf(a)),c="enhanced-table-checkbox-".concat(t);return r.a.createElement(Q.a,{hover:!0,onClick:function(t){return function(e,t){var a=p.indexOf(t),n=[];-1===a?n=n.concat(p,t):0===a?n=n.concat(p.slice(1)):a===p.length-1?n=n.concat(p.slice(0,-1)):a>0&&(n=n.concat(p.slice(0,a),p.slice(a+1))),f(n)}(0,e.username)},role:"checkbox","aria-checked":l,tabIndex:-1,key:e.id,selected:l},r.a.createElement(K.a,{padding:"checkbox"},r.a.createElement(Z.a,{checked:l,inputProps:{"aria-labelledby":c}})),r.a.createElement(K.a,{component:"th",scope:"row",padding:"none"},e.is_active?"Active":"Never connected"),r.a.createElement(K.a,{align:"left"},r.a.createElement(te.a,{variant:"subtitle2"},e.last_name),r.a.createElement(te.a,{variant:"caption"},e.first_name)),r.a.createElement(K.a,{align:"left",id:c},r.a.createElement(te.a,{variant:"subtitle2"},e.username),r.a.createElement(te.a,{variant:"caption"},e.email)),Object.keys(M).sort().map((function(t){return r.a.createElement(K.a,{align:"left",key:t},e.enrollments.hasOwnProperty(t)&&e.enrollments[t].enrollment_date?r.a.createElement(n.Fragment,null,r.a.createElement(te.a,{variant:"subtitle2"},"Enrolled"),r.a.createElement(te.a,{variant:"caption"},G()(e.enrollments[t].enrollment_date).format("MMM Do YY")),r.a.createElement(J.a,null),r.a.createElement(q.a,null)):r.a.createElement(n.Fragment,null,r.a.createElement(te.a,{variant:"subtitle2"},"Not enrolled"),r.a.createElement(q.a,null),r.a.createElement(X.a,null)))})))})),I>0&&r.a.createElement(Q.a,{style:{height:53*I}},r.a.createElement(K.a,{colSpan:6}))))),r.a.createElement(le.a,{rowsPerPageOptions:[5,10,25],component:"div",count:Object.keys(F).length,rowsPerPage:k,page:h,onChangePage:function(e,t){j(t)},onChangeRowsPerPage:function(e){_(parseInt(e.target.value,10)),j(0)}}))},de=function(){return r.a.createElement(n.Fragment,null,r.a.createElement(me,null))},be=function(){var e=Object(n.useState)(1),t=Object(E.a)(e,2),a=t[0],l=t[1],c=Object(n.useCallback)((function(e,t){l(t)}),[]);return r.a.createElement(n.Fragment,null,r.a.createElement(U,{value:a,handleChangeTab:c,tabsList:["Main","View Enrollments"]}),r.a.createElement(v,{value:a,index:0},r.a.createElement(I,null)),r.a.createElement(v,{value:a,index:1},r.a.createElement(de,null)))},Ee=Object(p.a)((function(){return{scrollablePaper:{margin:"20px 10px",padding:"10px",maxHeight:"80vh",overflow:"auto",direction:"rtl"},paper:{margin:"20px 10px",padding:"10px"}}})),pe=function(){var e=Ee(),t=Object(o.c)((function(e){return{courses:e.userManagement.courses}})).courses;return r.a.createElement(O.a,{container:!0},r.a.createElement(O.a,{item:!0,xs:4},r.a.createElement(k.a,{variant:"outlined",className:e.scrollablePaper},r.a.createElement(F,{courses:t}))),r.a.createElement(O.a,{item:!0,xs:8},r.a.createElement(k.a,{variant:"outlined",className:e.paper},r.a.createElement(be,null))))},fe=Object(p.a)((function(){return{root:{backgroundColor:h.palette.background.main,fontFamily:h.text.font.main,paddingTop:"70px",minHeight:"calc(100vh - 70px)","& .MuiTab-wrapper":{fontWeight:700}}}})),Oe=function(){var e=fe(),t=Object(n.useState)(1),a=Object(E.a)(t,2),l=a[0],c=a[1],o=Object(n.useCallback)((function(e,t){c(t)}),[]),i=Object(n.useCallback)((function(){return r.a.createElement(n.Fragment,null,r.a.createElement(v,{value:l,index:0},r.a.createElement(y,null)),r.a.createElement(v,{value:l,index:1},r.a.createElement(pe,null)))}),[l]);return r.a.createElement(f.a,{theme:h},r.a.createElement(O.a,{className:e.root},r.a.createElement(U,{value:l,handleChangeTab:o,tabsList:["Quick Search","User Management"]}),i()))},ge=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||i.d,he=Object(i.e)(b,{},ge(Object(i.a)(s.a)));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(o.a,{store:he},r.a.createElement(Oe,null))),document.getElementById("root"))}},[[82,1,2]]]);
//# sourceMappingURL=main.dd9375ef.chunk.js.map